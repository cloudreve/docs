# 媒体信息提取 {#media-meta}

Cloudreve 支持从视频、音频、图片中提取元数据，并将其保存到文件的元数据中，用于优化展示和检索文件。

## 提取逻辑

如果新文件符以下任一合要求，Cloudreve 会在文件上传完成后开始提取元数据。

- 存储策略开启了原生媒体信息提取，即 `存储策略设置` -> `媒体信息提取` 中设置的扩展名包含了文件的扩展名；
- 存储策略未开启原生媒体信息提取，但开启了代理媒体信息提取，即 `存储策略设置` -> `媒体信息提取` 中开启了 `代理提取媒体信息`。

所有提取任务都由一个队列统一管理，你可以在 `参数设置` -> `队列` -> `媒体信息提取` 中设置队列参数。任务执行时，Cloudreve 会按照流水线模式依次尝试每个提取器：

| 提取器       | 描述                                                                                                                                                                                                               |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 存储策略原生 | 根据存储策略提供商的媒体服务能力，可提取图片 EXIF 或音视频流参数。 使用此提取器后不会再执行后续提取器。                                                                                                            |
| EXIF         | 内置。提取图片的 EXIF 信息： 宽度、高度、GPS 坐标、拍摄者、版权信息、软件、相机信息、镜头信息、曝光参数、拍摄时间、照片方向等。源文件位于第三方存储端时，会尝试使用 Range 请求下载必要部分数据，无需完整下载文件。 |
| 音乐元数据   | 内置。提取音频格式、类型、歌手、专辑、作曲家、流派等信息。 源文件位于第三方存储端时，会尝试使用 Range 请求下载必要部分数据，无需完整下载文件。                                                                     |
| FFProbe      | 需安装[第三方依赖](./thumbnails#ffmpeg)。提取音视频流参数： 时长、比特率、帧率、码率、音频流、章节等信息。源文件位于第三方存储端时，会尝试使用 Range 请求下载必要部分数据，无需完整下载文件。                      |

你可以在 `参数设置` -> `媒体处理` -> `媒体信息提取` 中设置启用各个提取器。

### 提取器代理

你可以在 `存储策略设置` -> `媒体信息提取` -> `代理提取媒体信息` 中开启代理提取媒体信息功能，由 Cloudreve 处理并提取媒体信息。

## 用途

不同类型的媒体信息用途如下：

##### EXIF

- 搜索；
- 文件信息侧边栏展示；

##### 音乐元数据

- 搜索；
- 文件信息侧边栏展示；
- 音乐播放器展示；

##### 音视频流参数

- 搜索；
- 文件信息侧边栏展示；
- 章节信息可在 ArtPlayer 播放器进度条中展示；
  ::: warning
  只有 Cloudreve 的 FFProbe 可以提取章节数据，存储策略原生提取器无法提取。
  :::
